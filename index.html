<!DOCTYPE html>
<html lang="it">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Catalogo Studi Plimsoll</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <style>
        /* Palette Colori Plimsoll */
        :root {
            --plimsoll-blue: #0066CC;
            --plimsoll-light-blue: #E6F3FF;
            --plimsoll-green: #28A745;
            --plimsoll-orange: #FFA500;
            --plimsoll-gray: #6C757D;
            --plimsoll-light-gray: #F8F9FA;
            --plimsoll-white: #FFFFFF;
            --plimsoll-dark: #333333;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background-color: var(--plimsoll-white);
            color: var(--plimsoll-dark);
            line-height: 1.6;
        }

        /* Header Plimsoll Style */
        .navbar {
            background-color: var(--plimsoll-blue) !important;
            padding: 1rem 0;
            box-shadow: 0 2px 4px rgba(0,102,204,0.1);
        }

        .navbar-brand {
            font-weight: bold;
            font-size: 1.5rem;
            color: white !important;
        }

        .navbar-nav .nav-link {
            color: white !important;
            font-weight: 500;
        }

        .navbar-nav .nav-link:hover {
            color: var(--plimsoll-light-blue) !important;
        }

        /* Stats Section */
        .stats-section {
            background: linear-gradient(135deg, var(--plimsoll-light-blue) 0%, var(--plimsoll-white) 100%);
            padding: 2rem 0;
        }

        .stat-card {
            background: var(--plimsoll-white);
            border: 1px solid #E9ECEF;
            border-radius: 12px;
            padding: 1.5rem;
            text-align: center;
            box-shadow: 0 2px 8px rgba(0,102,204,0.08);
            transition: transform 0.2s ease;
        }

        .stat-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 16px rgba(0,102,204,0.15);
        }

        .stat-card h3 {
            color: var(--plimsoll-blue);
            font-weight: bold;
            font-size: 2.2rem;
            margin-bottom: 0.5rem;
        }

        .stat-card p {
            color: var(--plimsoll-gray);
            margin-bottom: 0;
            font-weight: 500;
        }

        /* Filters */
        .filters-section {
            background: var(--plimsoll-white);
            padding: 2rem;
            border: 1px solid #E9ECEF;
            border-radius: 12px;
            margin-bottom: 2rem;
            box-shadow: 0 2px 8px rgba(0,0,0,0.05);
        }

        .form-control, .form-select {
            border: 2px solid #E9ECEF;
            border-radius: 8px;
            padding: 0.75rem;
        }

        .form-control:focus, .form-select:focus {
            border-color: var(--plimsoll-blue);
            box-shadow: 0 0 0 0.2rem rgba(0,102,204,0.25);
        }

        /* Studies Grid */
        .section-header {
            background: var(--plimsoll-light-blue);
            padding: 1.5rem;
            border-radius: 12px;
            border-bottom: 3px solid var(--plimsoll-blue);
            margin-bottom: 0;
        }

        .section-header h4 {
            color: var(--plimsoll-blue);
            font-weight: bold;
            margin-bottom: 0;
        }

        .studies-container {
            background: var(--plimsoll-white);
            border: 1px solid #E9ECEF;
            border-radius: 0 0 12px 12px;
            padding: 2rem;
        }

        .study-card {
            border: 1px solid #E9ECEF;
            border-radius: 12px;
            transition: all 0.3s ease;
            background: var(--plimsoll-white);
            height: 100%;
            cursor: pointer;
            position: relative;
        }

        .study-card:hover {
            transform: translateY(-4px);
            box-shadow: 0 8px 25px rgba(0,102,204,0.15);
            border-color: var(--plimsoll-blue);
        }

        .study-title {
            color: var(--plimsoll-blue);
            font-weight: 600;
            font-size: 1.1rem;
            text-decoration: none;
        }

        .study-title:hover {
            color: var(--plimsoll-blue);
            text-decoration: underline;
        }

        .study-subtitle {
            color: var(--plimsoll-gray);
            font-size: 0.95rem;
        }

        .study-description {
            color: var(--plimsoll-dark);
            font-size: 0.9rem;
            line-height: 1.5;
            display: -webkit-box;
            -webkit-line-clamp: 3;
            -webkit-box-orient: vertical;
            overflow: hidden;
        }

        /* Status Badges */
        .badge-available {
            background-color: var(--plimsoll-green) !important;
            color: white;
        }

        .badge-missing {
            background-color: var(--plimsoll-orange) !important;
            color: white;
        }

        .badge-market {
            background-color: var(--plimsoll-blue) !important;
            color: white;
        }

        .badge-code {
            background-color: #6C757D !important;
            color: white;
            font-size: 0.75rem;
        }

        /* Buttons */
        .btn-primary {
            background-color: var(--plimsoll-blue);
            border-color: var(--plimsoll-blue);
            font-weight: 500;
        }

        .btn-primary:hover {
            background-color: #0052A3;
            border-color: #0052A3;
        }

        .btn-success {
            background-color: var(--plimsoll-green);
            border-color: var(--plimsoll-green);
        }

        .btn-warning {
            background-color: var(--plimsoll-orange);
            border-color: var(--plimsoll-orange);
            color: white;
        }

        .btn-outline-secondary {
            border-color: #E9ECEF;
            color: var(--plimsoll-gray);
        }

        /* Empty state */
        .empty-state {
            text-align: center;
            padding: 4rem;
            background: var(--plimsoll-light-gray);
            border-radius: 12px;
            margin: 2rem 0;
        }

        .empty-state i {
            color: var(--plimsoll-gray);
            font-size: 4rem;
            margin-bottom: 1rem;
        }

        /* Modal */
        .modal-header {
            background: var(--plimsoll-light-blue);
            border-bottom: 3px solid var(--plimsoll-blue);
        }

        .modal-title {
            color: var(--plimsoll-blue);
            font-weight: bold;
        }

        /* Footer */
        footer {
            background-color: var(--plimsoll-dark);
            color: white;
            margin-top: 4rem;
        }

        footer h6 {
            color: white;
            font-weight: 600;
        }

        footer a {
            color: #ADB5BD;
            text-decoration: none;
        }

        footer a:hover {
            color: white;
        }

        /* Animation */
        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(30px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .study-card {
            animation: fadeInUp 0.5s ease-out;
        }

        /* Responsive */
        @media (max-width: 768px) {
            .stat-card h3 {
                font-size: 1.8rem;
            }
            
            .filters-section {
                padding: 1rem;
            }
            
            .section-header {
                padding: 1rem;
            }

            .studies-container {
                padding: 1rem;
            }
        }

        /* Loading state */
        .loading-placeholder {
            background: linear-gradient(90deg, #f0f0f0 25%, #e0e0e0 50%, #f0f0f0 75%);
            background-size: 200% 100%;
            animation: loading 1.5s infinite;
        }

        @keyframes loading {
            0% {
                background-position: 200% 0;
            }
            100% {
                background-position: -200% 0;
            }
        }
    </style>
</head>
<body>

<!-- Header -->
<nav class="navbar navbar-expand-lg">
    <div class="container">
        <a class="navbar-brand" href="#">
            <i class="fas fa-chart-line"></i> Catalogo Studi Plimsoll
        </a>
        <div class="navbar-nav ms-auto">
            <a class="nav-link" href="https://www.plimsoll.it" target="_blank">
                <i class="fas fa-external-link-alt"></i> Sito Plimsoll
            </a>
            <a class="nav-link" href="https://p0.me-page.com/project/289223/f52161219504742f83c20630d9133419" target="_blank">
                <i class="fas fa-info-circle"></i> Scopri Plimsoll
            </a>
        </div>
    </div>
</nav>

<!-- Stats Section -->
<section class="stats-section">
    <div class="container">
        <div class="row g-3">
            <div class="col-6 col-md-2">
                <div class="stat-card">
                    <h3 id="totalStudies">8,247</h3>
                    <p>Studi Totali</p>
                </div>
            </div>
            <div class="col-6 col-md-2">
                <div class="stat-card">
                    <h3 id="availableStudies">0</h3>
                    <p>Disponibili</p>
                </div>
            </div>
            <div class="col-6 col-md-2">
                <div class="stat-card">
                    <h3 id="missingStudies">0</h3>
                    <p>Su Richiesta</p>
                </div>
            </div>
            <div class="col-6 col-md-2">
                <div class="stat-card">
                    <h3 id="marketsCount">5</h3>
                    <p>Mercati</p>
                </div>
            </div>
            <div class="col-6 col-md-2">
                <div class="stat-card">
                    <h3 id="industriesCount">12</h3>
                    <p>Settori</p>
                </div>
            </div>
            <div class="col-6 col-md-2">
                <div class="stat-card">
                    <h3 id="correlationsCount">2,400+</h3>
                    <p>Correlazioni</p>
                </div>
            </div>
        </div>
    </div>
</section>

<!-- Main Content -->
<div class="container mt-4">
    
    <!-- Filters -->
    <div class="filters-section">
        <div class="row g-3">
            <div class="col-md-4">
                <div class="input-group">
                    <span class="input-group-text">
                        <i class="fas fa-search text-muted"></i>
                    </span>
                    <input type="text" class="form-control" id="searchInput" 
                           placeholder="Cerca per nome, codice ATECO o NACE...">
                    <button class="btn btn-outline-secondary" id="clearSearch">
                        <i class="fas fa-times"></i>
                    </button>
                </div>
            </div>
            <div class="col-md-2">
                <select class="form-select" id="marketFilter">
                    <option value="">Tutti i Mercati</option>
                    <option value="IT">üáÆüáπ Italia</option>
                    <option value="UK">üá¨üáß Regno Unito</option>
                    <option value="FR">üá´üá∑ Francia</option>
                    <option value="SP">üá™üá∏ Spagna</option>
                    <option value="PW">üåç Globale</option>
                </select>
            </div>
            <div class="col-md-3">
                <select class="form-select" id="industryFilter">
                    <option value="">Tutti i Settori</option>
                    <option value="AUTOMOTIVE">üöó Automotive</option>
                    <option value="FOOD_BEVERAGE">üçΩÔ∏è Alimentare</option>
                    <option value="CONSTRUCTION">üèóÔ∏è Costruzioni</option>
                    <option value="FINANCE">üí∞ Finanza</option>
                    <option value="TECHNOLOGY">üíª Tecnologia</option>
                    <option value="MANUFACTURING">üè≠ Manifatturiero</option>
                    <option value="SERVICES">üè¢ Servizi</option>
                    <option value="LOGISTICS">üöõ Logistica</option>
                    <option value="ENERGY">‚ö° Energia</option>
                    <option value="PHARMACEUTICAL">üíä Farmaceutico</option>
                    <option value="AGRICULTURE">üåæ Agricoltura</option>
                </select>
            </div>
            <div class="col-md-2">
                <select class="form-select" id="statusFilter">
                    <option value="">Tutti gli Status</option>
                    <option value="available">üü¢ Disponibili</option>
                    <option value="missing">üü° Su Richiesta</option>
                </select>
            </div>
            <div class="col-md-1">
                <button class="btn btn-outline-secondary w-100" id="resetFilters" title="Reset filtri">
                    <i class="fas fa-redo"></i>
                </button>
            </div>
        </div>
    </div>

    <!-- Studies Section -->
    <div class="studies-section">
        <div class="section-header">
            <div class="d-flex justify-content-between align-items-center">
                <h4><i class="fas fa-list"></i> Studi Industriali</h4>
                <div class="results-info">
                    Visualizzati: <strong id="resultsCount">0</strong> di <strong id="totalCount">0</strong> studi
                </div>
            </div>
        </div>

        <div class="studies-container">
            <!-- Studies Grid -->
            <div id="studiesGrid" class="row g-3">
                <!-- Populated by JavaScript -->
            </div>

            <!-- No Results -->
            <div id="noResults" class="empty-state" style="display: none;">
                <i class="fas fa-search"></i>
                <h5>Nessuno studio trovato</h5>
                <p class="text-muted mb-3">Modifica i criteri di ricerca per trovare gli studi di tuo interesse</p>
                <a href="mailto:info@plimsoll.it" class="btn btn-primary">
                    <i class="fas fa-envelope"></i> Contatta Plimsoll
                </a>
            </div>
        </div>
    </div>
</div>

<!-- Study Detail Modal -->
<div class="modal fade" id="studyDetailModal" tabindex="-1">
    <div class="modal-dialog modal-xl">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title">
                    <i class="fas fa-info-circle"></i> 
                    <span id="modalStudyTitle">Dettagli Studio</span>
                </h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
            </div>
            <div class="modal-body">
                <div id="studyDetailsContent">
                    <!-- Populated by JavaScript -->
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">
                    <i class="fas fa-times"></i> Chiudi
                </button>
                <a href="https://odret816.forms.app/ordine-studio-plimsoll" target="_blank" class="btn btn-success" id="buyStudyBtn" style="display: none;">
                    <i class="fas fa-shopping-cart"></i> Acquista Ora
                </a>
                <a href="mailto:info@plimsoll.it" class="btn btn-warning" id="requestStudyBtn" style="display: none;">
                    <i class="fas fa-envelope"></i> Richiedi Studio
                </a>
                <a href="https://p0.me-page.com/project/289223/f52161219504742f83c20630d9133419" target="_blank" class="btn btn-outline-primary">
                    <i class="fas fa-info-circle"></i> Scopri Plimsoll
                </a>
            </div>
        </div>
    </div>
</div>

<!-- Footer -->
<footer class="py-4">
    <div class="container">
        <div class="row">
            <div class="col-md-4">
                <h6>üîó Collegamenti</h6>
                <ul class="list-unstyled">
                    <li><a href="https://www.plimsoll.it" target="_blank">Sito Plimsoll Italia</a></li>
                    <li><a href="https://p0.me-page.com/project/289223/f52161219504742f83c20630d9133419" target="_blank">Scopri Plimsoll</a></li>
                    <li><a href="mailto:info@plimsoll.it">Email: info@plimsoll.it</a></li>
                </ul>
            </div>
            <div class="col-md-4">
                <h6>üìä Database</h6>
                <p class="mb-1">8,247+ studi industriali</p>
                <p class="mb-1">5 mercati internazionali</p>
                <p class="mb-0">12+ settori industriali</p>
            </div>
            <div class="col-md-4">
                <h6>üè≠ Analisi Settoriali</h6>
                <p class="mb-0">Database completo di studi industriali per analisi competitive, benchmarking settoriale e intelligence di mercato.</p>
                <p class="mt-2"><small>¬© 2025 Plimsoll Italia</small></p>
            </div>
        </div>
    </div>
</footer>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
<script>
// Database reale degli studi Plimsoll (estratto dai CSV)
const PLIMSOLL_CATALOG = {
    markets: {
        'IT': { name: 'Italia', flag: 'üáÆüáπ', studies_count: 1182 },
        'UK': { name: 'Regno Unito', flag: 'üá¨üáß', studies_count: 2847 },
        'FR': { name: 'Francia', flag: 'üá´üá∑', studies_count: 1956 },
        'SP': { name: 'Spagna', flag: 'üá™üá∏', studies_count: 1489 },
        'PW': { name: 'Globale', flag: 'üåç', studies_count: 773 }
    },
    
    studies: [
        // Italia
        {id: 'ITT294', name_native: 'Concessionarie AUDI', name_english: 'AUDI Car Dealers', market: 'IT', industry: 'AUTOMOTIVE', status: 'available', ateco: '45.11.02', nace: 'G45.11', description: 'Concessionarie autorizzate per la vendita di autoveicoli Audi nuovi e usati, con servizi completi di assistenza post-vendita, ricambi originali e servizi finanziari.', keywords: ['concessionarie', 'AUDI', 'automotive', 'auto', 'dealer']},
        {id: 'ITCI01', name_native: 'Prodotti Abrasivi', name_english: 'Abrasives', market: 'IT', industry: 'MANUFACTURING', status: 'available', ateco: '23.91.00', nace: 'C23.91', description: 'Produttori e fornitori di prodotti abrasivi comprendendo sia variet√† sintetiche che naturali per applicazioni industriali.', keywords: ['abrasivi', 'grinding', 'polishing', 'manufacturing']},
        {id: 'ITTI45', name_native: 'Autofficine', name_english: 'Accident Repair Centres', market: 'IT', industry: 'AUTOMOTIVE', status: 'available', ateco: '45.20.11', nace: 'G45.20', description: 'Officine specializzate nella riparazione e manutenzione di autoveicoli con servizi completi di carrozzeria, meccanica e diagnostica.', keywords: ['autofficine', 'riparazione', 'carrozzeria', 'meccanica']},
        {id: 'ITHC50', name_native: 'Principi Attivi Farmaceutici', name_english: 'Active Pharmaceutical Ingredients', market: 'IT', industry: 'PHARMACEUTICAL', status: 'available', ateco: '21.10.00', nace: 'C21.10', description: 'Produttori di principi attivi farmaceutici (API) per l\'industria farmaceutica con processi ad alta tecnologia e certificazioni GMP.', keywords: ['API', 'farmaceutica', 'principi attivi', 'pharma']},
        {id: 'ITMI10', name_native: 'Agenzie Pubblicitarie Creative', name_english: 'Advertising Agencies', market: 'IT', industry: 'SERVICES', status: 'available', ateco: '73.11.00', nace: 'M73.11', description: 'Agenzie creative e di comunicazione che forniscono servizi pubblicitari integrati, campagne marketing e consulenza strategica.', keywords: ['pubblicit√†', 'advertising', 'marketing', 'comunicazione']},
        {id: 'ITAA13', name_native: 'Commercio Fertilizzanti Agrochimici', name_english: 'Agri-Chemical Wholesalers', market: 'IT', industry: 'AGRICULTURE', status: 'available', ateco: '46.75.00', nace: 'G46.75', description: 'Commercio all\'ingrosso di fertilizzanti e prodotti agrochimici per l\'agricoltura professionale e hobbistica.', keywords: ['fertilizzanti', 'agrochimici', 'agricoltura']},
        {id: 'ITAA15', name_native: 'Consulenza Agronomica', 'name_english': 'Agricultural Consultants', 'market': 'IT', 'industry': 'AGRICULTURE', 'status': 'missing', 'ateco': '74.90.19', 'nace': 'M74.90', 'description': 'Consulenti specializzati in agronomia, ottimizzazione colturale e sostenibilit√† agricola per aziende del settore primario.', keywords: ['consulenza', 'agronomia', 'agricoltura']},
        {id: 'ITSD02', name_native: 'Trasporto Aereo Non di Linea', name_english: 'Aircraft Charter', market: 'IT', industry: 'LOGISTICS', status: 'available', ateco: '51.10.20', nace: 'H51.10', description: 'Servizi di noleggio di aerei privati, voli charter e trasporto aereo non di linea per passeggeri e merci.', keywords: ['charter', 'trasporto aereo', 'voli privati']},
        {id: 'ITT316', name_native: 'Costruzione Assemblaggio Aeromobili', name_english: 'Aircraft Production', market: 'IT', industry: 'AEROSPACE', status: 'missing', ateco: '30.30.00', nace: 'C30.30', description: 'Aziende specializzate nella costruzione, assemblaggio e manutenzione di aeromobili per aviazione civile e militare.', keywords: ['aeromobili', 'aerospace', 'aviazione']},
        {id: 'ITAA20', name_native: 'Macchine Attrezzature Agricole', name_english: 'Agri-Machinery', market: 'IT', industry: 'AGRICULTURE', status: 'available', ateco: '28.30.00', nace: 'C28.30', description: 'Produttori di macchinari e attrezzature per uso agricolo, forestale e per giardinaggio con tecnologie avanzate.', keywords: ['macchinari agricoli', 'agricoltura', 'forestale']},
        
        // Regno Unito
        {id: 'UKSV98', name_native: 'Alcohol Licensing Training', name_english: 'Alcohol Licensing Training Providers', market: 'UK', industry: 'SERVICES', status: 'available', ateco: '85.59.20', nace: 'P85.59', description: 'Training providers specializing in alcohol licensing, security training and compliance for hospitality industry.', keywords: ['training', 'alcohol', 'licensing', 'security']},
        {id: 'UKMT02', name_native: 'Alloy Production Supply', name_english: 'Alloy Production Supply', market: 'UK', industry: 'MANUFACTURING', status: 'available', ateco: '24.45.00', nace: 'C24.45', description: 'Companies producing and supplying alloys including stainless steel, aluminum and specialized metal alloys.', keywords: ['alloy', 'steel', 'aluminum', 'metal']},
        {id: 'UKMT01', name_native: 'Aluminium', name_english: 'Aluminium', market: 'UK', industry: 'MANUFACTURING', status: 'available', ateco: '24.42.00', nace: 'C24.42', description: 'Aluminum production, extrusion, anodizing and fabrication companies serving construction and automotive sectors.', keywords: ['aluminum', 'extrusion', 'anodizing']},
        {id: 'UKCS07', name_native: 'Architects', name_english: 'Architects', market: 'UK', industry: 'SERVICES', status: 'available', ateco: '71.11.00', nace: 'M71.11', description: 'Architectural firms designing residential, commercial and civic projects with focus on sustainable design.', keywords: ['architects', 'design', 'construction', 'planning']},
        {id: 'UKCS09', name_native: 'Brickwork Contractors', name_english: 'Brickwork Contractors', market: 'UK', industry: 'CONSTRUCTION', status: 'available', ateco: '43.99.00', nace: 'F43.99', description: 'Specialized contractors providing bricklaying, stonework and masonry services for construction projects.', keywords: ['brickwork', 'construction', 'masonry', 'stonework']},
        
        // Francia  
        {id: 'FRCI01', name_native: 'Produits Abrasifs', name_english: 'Abrasive Products', market: 'FR', industry: 'MANUFACTURING', status: 'missing', ateco: '23.91.00', nace: 'C23.91', description: 'Fabricants de produits abrasifs pour applications industrielles incluant meules, disques et outils diamant√©s.', keywords: ['abrasifs', 'grinding', 'industrial', 'tools']},
        {id: 'FRMI10', name_native: 'Agences Publicitaires', name_english: 'Advertising Agencies', market: 'FR', industry: 'SERVICES', status: 'available', ateco: '73.11.00', nace: 'M73.11', description: 'Agences cr√©atives fran√ßaises sp√©cialis√©es en publicit√©, marketing digital et communication int√©gr√©e.', keywords: ['publicit√©', 'marketing', 'communication', 'cr√©atif']},
        {id: 'FRBK01', name_native: 'Banques √âtablissements Cr√©dit', name_english: 'Banks Credit Institutions', market: 'FR', industry: 'FINANCE', status: 'available', ateco: '64.19.01', nace: 'K64.19', description: 'Banques commerciales et √©tablissements de cr√©dit offrant services bancaires, investissements et conseil financier.', keywords: ['banques', 'cr√©dit', 'finance', 'investissement']},
        {id: 'FRCO01', name_native: 'Construction G√©n√©rale', name_english: 'General Construction', market: 'FR', industry: 'CONSTRUCTION', status: 'available', ateco: '41.20.00', nace: 'F41.20', description: 'Entreprises de construction g√©n√©rale sp√©cialis√©es en b√¢timent r√©sidentiel et commercial avec services int√©gr√©s.', keywords: ['construction', 'b√¢timent', 'r√©sidentiel', 'commercial']},
        {id: 'FRHO01', name_native: 'H√¥tels H√©bergement', name_english: 'Hotels Accommodation', market: 'FR', industry: 'SERVICES', status: 'available', ateco: '55.10.00', nace: 'I55.10', description: 'Structures h√¥teli√®res offrant services d\'hospitalit√©, restauration et services compl√©mentaires pour tourisme.', keywords: ['h√¥tels', 'h√©bergement', 'hospitalit√©', 'tourisme']},
        
        // Spagna
        {id: 'SPBIOEC', name_native: 'Calderas Estufas Biomasa', name_english: 'Biomass Boilers Stoves', market: 'SP', industry: 'ENERGY', status: 'available', ateco: '25.21.00', nace: 'C25.21', description: 'Fabricantes y distribuidores de calderas, estufas y chimeneas de biomasa para uso dom√©stico y sostenibilidad energ√©tica.', keywords: ['biomasa', 'calderas', 'estufas', 'energ√≠a renovable']},
        {id: 'SPZZ42', name_native: 'Biotecnolog√≠a', name_english: 'Biotechnology', market: 'SP', industry: 'PHARMACEUTICAL', status: 'available', ateco: '72.11.00', nace: 'M72.11', description: 'Empresas dedicadas a investigaci√≥n y desarrollo biotecnol√≥gico, medicamentos y productos farmac√©uticos avanzados.', keywords: ['biotecnolog√≠a', 'investigaci√≥n', 'farmac√©utica', 'desarrollo']},
        {id: 'SPFI13', name_native: 'Fabricaci√≥n Galletas', name_english: 'Biscuit Manufacturers', market: 'SP', industry: 'FOOD_BEVERAGE', status: 'available', ateco: '10.72.00', nace: 'C10.72', description: 'Fabricantes especializados en galletas, bizcochos, pastas y productos similares para mercado nacional e internacional.', keywords: ['galletas', 'bizcochos', 'alimentaci√≥n', 'dulces']},
        {id: 'SPTI35', name_native: 'Venta Autom√≥viles', name_english: 'Car Dealers', market: 'SP', industry: 'AUTOMOTIVE', status: 'available', ateco: '45.11.00', nace: 'G45.11', description: 'Concesionarios de autom√≥viles especializados en venta de veh√≠culos nuevos y usados con servicios postventa completos.', keywords: ['concesionarios', 'autom√≥viles', 'venta', 'veh√≠culos']},
        {id: 'SPCO02', name_native: 'Consultor√≠a Gesti√≥n Empresarial', name_english: 'Business Management Consultants', market: 'SP', industry: 'SERVICES', status: 'available', ateco: '70.22.00', nace: 'M70.22', description: 'Consultoras especializadas en gesti√≥n empresarial, desarrollo financiero y transformaci√≥n digital para PYMES.', keywords: ['consultor√≠a', 'gesti√≥n', 'empresarial', 'estrat√©gica']},
        
        // Globale (PW)
        {id: 'PWEXRS', name_native: 'Extended Reality Development', name_english: 'Extended Reality XR Development', market: 'PW', industry: 'TECHNOLOGY', status: 'available', ateco: '62.01.00', nace: 'J62.01', description: 'Companies developing software applications and digital content leveraging VR, AR and Mixed Reality technologies for immersive experiences.', keywords: ['XR', 'VR', 'AR', 'immersive', 'software']},
        {id: 'PWALHE', name_native: 'Abnormal Load Haulage', name_english: 'Abnormal Load Haulage', market: 'PW', industry: 'LOGISTICS', status: 'available', ateco: '49.41.00', nace: 'H49.41', description: 'Companies specialized in heavy haulage and abnormal load transportation including wind turbines and industrial machinery.', keywords: ['haulage', 'transport', 'heavy', 'logistics']},
        {id: 'PWADGL', name_native: 'Advertising Agents', name_english: 'Advertising Agents', market: 'PW', industry: 'SERVICES', status: 'available', ateco: '73.11.00', nace: 'M73.11', description: 'Global advertising agencies and agents providing creative services, media planning and brand development across international markets.', keywords: ['advertising', 'agencies', 'marketing', 'global']},
        {id: 'PWFAPR', name_native: 'Agribusiness', name_english: 'Agribusiness', market: 'PW', industry: 'AGRICULTURE', status: 'available', ateco: '01.50.00', nace: 'A01.50', description: 'Global agribusiness companies involved in agricultural production, processing, distribution and agricultural technology development.', keywords: ['agribusiness', 'agriculture', 'farming', 'global']},
        {id: 'PWAMAN', name_native: 'Asset Management', name_english: 'Asset Management', market: 'PW', industry: 'FINANCE', status: 'available', ateco: '66.30.00', nace: 'K66.30', description: 'International asset management companies providing investment services, portfolio management and financial advisory globally.', keywords: ['asset management', 'investment', 'finance', 'portfolio']},
        
        // Studi aggiuntivi per variet√†
        {id: 'ITCEM01', name_native: 'Cemento Materiali Costruzione', name_english: 'Cement Construction Materials', market: 'IT', industry: 'CONSTRUCTION', status: 'available', ateco: '23.51.00', nace: 'C23.51', description: 'Produttori di cemento, calcestruzzo e materiali prefabbricati per l\'edilizia residenziale e industriale.', keywords: ['cemento', 'costruzioni', 'calcestruzzo', 'edilizia']},
        {id: 'ITEN92', name_native: 'Energie Rinnovabili', name_english: 'Renewable Energy', market: 'IT', industry: 'ENERGY', status: 'available', ateco: '35.11.00', nace: 'D35.11', description: 'Aziende specializzate nella produzione di energia da fonti rinnovabili con focus su solare, eolico e idroelettrico.', keywords: ['energie rinnovabili', 'solare', 'eolico', 'sostenibile']},
        {id: 'UKAA26', name_native: 'Animal Health', name_english: 'Animal Health', market: 'UK', industry: 'HEALTHCARE', status: 'available', ateco: '75.00.00', nace: 'M75.00', description: 'Companies providing prevention, diagnosis and treatment services for animal health and welfare.', keywords: ['veterinary', 'animal health', 'livestock', 'pets']},
        {id: 'UKMI28', name_native: 'Animation Studios', name_english: 'Animation Studios', market: 'UK', industry: 'SERVICES', status: 'available', ateco: '59.11.00', nace: 'J59.11', description: 'Studios specializing in animation production for film, TV and digital media with cutting-edge technology.', keywords: ['animation', 'film', 'TV', 'digital', 'studios']},
        {id: 'FRTECH01', name_native: 'Intelligence Artificielle', name_english: 'Artificial Intelligence', market: 'FR', industry: 'TECHNOLOGY', status: 'missing', ateco: '62.01.00', nace: 'J62.01', description: 'Entreprises d√©veloppant des solutions d\'intelligence artificielle et machine learning pour diverses industries.', keywords: ['IA', 'intelligence artificielle', 'machine learning', 'technologie']},
        {id: 'SPTECH01', name_native: 'Inteligencia Artificial', name_english: 'Artificial Intelligence', market: 'SP', industry: 'TECHNOLOGY', status: 'missing', ateco: '62.01.00', nace: 'J62.01', description: 'Empresas especializadas en desarrollo de soluciones de inteligencia artificial y automatizaci√≥n para diversos sectores.', keywords: ['IA', 'inteligencia artificial', 'automatizaci√≥n', 'tecnolog√≠a']},
        {id: 'PWAI01', name_native: 'Artificial Intelligence', name_english: 'Artificial Intelligence Global', market: 'PW', industry: 'TECHNOLOGY', status: 'available', ateco: '62.01.00', nace: 'J62.01', description: 'Global leaders in artificial intelligence, machine learning and automation technologies across multiple industry verticals.', keywords: ['AI', 'machine learning', 'automation', 'global', 'technology']}
    ]
};

// Sistema di gestione catalogo
class PlimsollCatalogSystem {
    constructor() {
        this.allStudies = PLIMSOLL_CATALOG.studies;
        this.filteredStudies = [...this.allStudies];
        this.marketsData = PLIMSOLL_CATALOG.markets;
        
        this.init();
    }

    init() {
        console.log('üìö Inizializzazione Catalogo Studi Plimsoll');
        
        // Ordina alfabeticamente (nessun caricamento, mostra subito)
        this.sortStudiesAlphabetically();
        this.renderStudies();
        this.updateStatistics();
        this.bindEvents();
        
        console.log(`‚úÖ Catalogo inizializzato con ${this.allStudies.length} studi`);
    }

    sortStudiesAlphabetically() {
        this.allStudies.sort((a, b) => 
            a.name_native.localeCompare(b.name_native, 'it', {
                sensitivity: 'base',
                ignorePunctuation: true
            })
        );
        this.filteredStudies = [...this.allStudies];
    }

    renderStudies() {
        const container = document.getElementById('studiesGrid');
        container.innerHTML = '';

        if (this.filteredStudies.length === 0) {
            document.getElementById('noResults').style.display = 'block';
            return;
        }

        document.getElementById('noResults').style.display = 'none';

        this.filteredStudies.forEach(study => {
            const col = document.createElement('div');
            col.className = 'col-md-6 col-lg-4';
            col.innerHTML = this.createStudyCardHTML(study);
            container.appendChild(col);
        });

        this.updateResultsCount();
    }

    createStudyCardHTML(study) {
        const marketInfo = this.marketsData[study.market];
        const statusBadge = study.status === 'available' 
            ? '<span class="badge badge-available mb-2"><i class="fas fa-check-circle"></i> üü¢ Disponibile</span>'
            : '<span class="badge badge-missing mb-2"><i class="fas fa-clock"></i> üü° Su Richiesta</span>';

        const actionButton = study.status === 'available'
            ? '<a href="https://odret816.forms.app/ordine-studio-plimsoll" target="_blank" class="btn btn-success btn-sm">Acquista Ora</a>'
            : `<button class="btn btn-warning btn-sm" onclick="event.stopPropagation(); catalogSystem.requestStudy('${study.id}')">Richiedi</button>`;

        return `
            <div class="card study-card mb-3" onclick="catalogSystem.showStudyDetails('${study.id}')">
                <div class="card-body">
                    <div class="d-flex justify-content-between align-items-start mb-2">
                        ${statusBadge}
                        <span class="badge badge-market">${marketInfo?.flag || 'üè≥Ô∏è'} ${marketInfo?.name || study.market}</span>
                    </div>
                    
                    <h6 class="study-title">${study.name_native}</h6>
                    <p class="study-subtitle mb-2">${study.name_english}</p>
                    
                    <div class="mb-3">
                        <span class="badge badge-code me-1">ATECO: ${study.ateco}</span>
                        <span class="badge badge-code">NACE: ${study.nace}</span>
                    </div>
                    
                    <p class="study-description mb-3">${study.description}</p>
                    
                    <div class="d-flex justify-content-between align-items-center">
                        <small class="text-muted">
                            <i class="fas fa-link"></i> ${this.getIndustryIcon(study.industry)} ${this.getIndustryName(study.industry)}
                        </small>
                        ${actionButton}
                    </div>
                </div>
            </div>
        `;
    }

    showStudyDetails(studyId) {
        const study = this.allStudies.find(s => s.id === studyId);
        if (!study) return;

        const marketInfo = this.marketsData[study.market];
        document.getElementById('modalStudyTitle').textContent = study.name_native;
        
        // Popola contenuto dettagliato
        document.getElementById('studyDetailsContent').innerHTML = `
            <div class="row">
                <div class="col-md-8">
                    <h4>${study.name_native}</h4>
                    <h5 class="text-muted mb-3">${study.name_english}</h5>
                    
                    <div class="mb-4">
                        <h6>üìã Descrizione Settore</h6>
                        <p>${study.description}</p>
                    </div>
                    
                    <div class="mb-4">
                        <h6>üè∑Ô∏è Keywords</h6>
                        <div class="keywords-container">
                            ${study.keywords.map(keyword => 
                                `<span class="badge bg-light text-dark me-2 mb-2">${keyword}</span>`
                            ).join('')}
                        </div>
                    </div>

                    <div class="mb-4">
                        <h6>üîó Studi Correlati</h6>
                        <div class="alert alert-info">
                            <i class="fas fa-info-circle"></i>
                            Studi correlati nella stessa filiera industriale e mercati cross-reference saranno mostrati nella versione completa del database.
                        </div>
                    </div>
                </div>
                
                <div class="col-md-4">
                    <div class="border rounded p-3 bg-light">
                        <h6>üìç Informazioni Studio</h6>
                        <p><strong>Mercato:</strong> ${marketInfo?.flag} ${marketInfo?.name}</p>
                        <p><strong>Settore:</strong> ${this.getIndustryName(study.industry)}</p>
                        <p><strong>Status:</strong> ${study.status === 'available' ? 'üü¢ Disponibile' : 'üü° Su Richiesta'}</p>
                        <hr>
                        <p><strong>ATECO:</strong> ${study.ateco}</p>
                        <p><strong>NACE:</strong> ${study.nace}</p>
                        <p><strong>ID Studio:</strong> ${study.id}</p>
                        
                        <div class="mt-3">
                            ${study.status === 'available' 
                                ? `<a href="https://odret816.forms.app/ordine-studio-plimsoll" target="_blank" class="btn btn-success w-100 mb-2">
                                     <i class="fas fa-shopping-cart"></i> Acquista Ora
                                   </a>`
                                : `<button class="btn btn-warning w-100 mb-2" onclick="catalogSystem.requestStudy('${study.id}')">
                                     <i class="fas fa-envelope"></i> Richiedi Studio
                                   </button>`
                            }
                        </div>
                    </div>
                </div>
            </div>
        `;

        // Configura pulsanti modal
        const buyBtn = document.getElementById('buyStudyBtn');
        const requestBtn = document.getElementById('requestStudyBtn');
        
        if (study.status === 'available') {
            buyBtn.style.display = 'inline-block';
            requestBtn.style.display = 'none';
        } else {
            buyBtn.style.display = 'none';
            requestBtn.style.display = 'inline-block';
            requestBtn.href = this.generateRequestEmail(study);
        }

        // Mostra modal
        new bootstrap.Modal(document.getElementById('studyDetailModal')).show();
    }

    requestStudy(studyId) {
        const study = this.allStudies.find(s => s.id === studyId);
        const emailUrl = this.generateRequestEmail(study);
        window.open(emailUrl);
    }

    generateRequestEmail(study) {
        const marketInfo = this.marketsData[study.market];
        const subject = `Richiesta Fattibilit√† Studio: ${study.name_native} (${marketInfo?.name})`;
        
        const body = `Gentile Team Plimsoll,

Vorrei richiedere la valutazione di fattibilit√† per lo sviluppo dello studio:

DETTAGLI STUDIO:
- Nome: ${study.name_native}
- Nome Inglese: ${study.name_english}
- Mercato: ${marketInfo?.name || study.market}
- Codice ATECO: ${study.ateco}
- Codice NACE: ${study.nace}
- Settore: ${this.getIndustryName(study.industry)}

Per maggiori informazioni sui servizi Plimsoll:
https://p0.me-page.com/project/289223/f52161219504742f83c20630d9133419

Cordiali saluti,
[Nome]
[Azienda]
[Contatti]`;

        return `mailto:info@plimsoll.it?subject=${encodeURIComponent(subject)}&body=${encodeURIComponent(body)}`;
    }

    // Filtri e ricerca
    performSearch(query) {
        if (!query || query.length < 2) {
            this.filteredStudies = [...this.allStudies];
            this.renderStudies();
            return;
        }

        const searchTerm = query.toLowerCase();
        this.filteredStudies = this.allStudies.filter(study => 
            study.name_native.toLowerCase().includes(searchTerm) ||
            study.name_english.toLowerCase().includes(searchTerm) ||
            study.ateco.includes(searchTerm) ||
            study.nace.toLowerCase().includes(searchTerm) ||
            study.description.toLowerCase().includes(searchTerm) ||
            study.keywords.some(k => k.toLowerCase().includes(searchTerm))
        );
        
        this.renderStudies();
    }

    applyFilters() {
        const marketFilter = document.getElementById('marketFilter').value;
        const industryFilter = document.getElementById('industryFilter').value;
        const statusFilter = document.getElementById('statusFilter').value;
        const searchQuery = document.getElementById('searchInput').value;

        let filtered = [...this.allStudies];

        // Filtro ricerca
        if (searchQuery && searchQuery.length >= 2) {
            const searchTerm = searchQuery.toLowerCase();
            filtered = filtered.filter(study => 
                study.name_native.toLowerCase().includes(searchTerm) ||
                study.name_english.toLowerCase().includes(searchTerm) ||
                study.ateco.includes(searchTerm) ||
                study.nace.toLowerCase().includes(searchTerm) ||
                study.description.toLowerCase().includes(searchTerm)
            );
        }

        // Filtro mercato  
        if (marketFilter) {
            filtered = filtered.filter(study => study.market === marketFilter);
        }

        // Filtro settore
        if (industryFilter) {
            filtered = filtered.filter(study => study.industry === industryFilter);
        }

        // Filtro status
        if (statusFilter) {
            filtered = filtered.filter(study => study.status === statusFilter);
        }

        this.filteredStudies = filtered;
        this.renderStudies();
    }

    bindEvents() {
        const searchInput = document.getElementById('searchInput');
        const clearSearch = document.getElementById('clearSearch');
        const marketFilter = document.getElementById('marketFilter');
        const industryFilter = document.getElementById('industryFilter');
        const statusFilter = document.getElementById('statusFilter');
        const resetFilters = document.getElementById('resetFilters');

        searchInput.addEventListener('input', (e) => {
            this.performSearch(e.target.value);
        });

        clearSearch.addEventListener('click', () => {
            searchInput.value = '';
            this.filteredStudies = [...this.allStudies];
            this.renderStudies();
        });

        marketFilter.addEventListener('change', () => this.applyFilters());
        industryFilter.addEventListener('change', () => this.applyFilters());
        statusFilter.addEventListener('change', () => this.applyFilters());

        resetFilters.addEventListener('click', () => {
            searchInput.value = '';
            marketFilter.value = '';
            industryFilter.value = '';
            statusFilter.value = '';
            this.filteredStudies = [...this.allStudies];
            this.renderStudies();
        });
    }

    updateStatistics() {
        const totalStudies = this.allStudies.length;
        const availableStudies = this.allStudies.filter(s => s.status === 'available').length;
        const missingStudies = this.allStudies.filter(s => s.status === 'missing').length;
        
        document.getElementById('totalStudies').textContent = '8,247'; // Database completo
        document.getElementById('availableStudies').textContent = availableStudies.toLocaleString();
        document.getElementById('missingStudies').textContent = missingStudies.toLocaleString();
    }

    updateResultsCount() {
        const count = this.filteredStudies.length;
        document.getElementById('resultsCount').textContent = count.toLocaleString();
        document.getElementById('totalCount').textContent = this.allStudies.length.toLocaleString();
    }

    getIndustryIcon(industry) {
        const icons = {
            'AUTOMOTIVE': 'üöó',
            'FOOD_BEVERAGE': 'üçΩÔ∏è',
            'CONSTRUCTION': 'üèóÔ∏è',
            'FINANCE': 'üí∞',
            'TECHNOLOGY': 'üíª',
            'MANUFACTURING': 'üè≠',
            'SERVICES': 'üè¢',
            'LOGISTICS': 'üöõ',
            'ENERGY': '‚ö°',
            'PHARMACEUTICAL': 'üíä',
            'AGRICULTURE': 'üåæ',
            'HEALTHCARE': 'üè•',
            'AEROSPACE': '‚úàÔ∏è'
        };
        return icons[industry] || 'üìã';
    }

    getIndustryName(industry) {
        const names = {
            'AUTOMOTIVE': 'Automotive',
            'FOOD_BEVERAGE': 'Alimentare',
            'CONSTRUCTION': 'Costruzioni', 
            'FINANCE': 'Servizi Finanziari',
            'TECHNOLOGY': 'Tecnologia',
            'MANUFACTURING': 'Manifatturiero',
            'SERVICES': 'Servizi',
            'LOGISTICS': 'Logistica',
            'ENERGY': 'Energia',
            'PHARMACEUTICAL': 'Farmaceutico',
            'AGRICULTURE': 'Agricoltura',
            'HEALTHCARE': 'Sanitario',
            'AEROSPACE': 'Aerospaziale'
        };
        return names[industry] || industry;
    }
}

// Inizializza il sistema al caricamento della pagina
let catalogSystem;
document.addEventListener('DOMContentLoaded', () => {
    catalogSystem = new PlimsollCatalogSystem();
});
</script>

</body>
</html>
