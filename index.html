<!DOCTYPE html>
<html lang="it">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Catalogo Studi Plimsoll - Gestione Settori</title>
    <link rel="stylesheet" href="assets/css/style.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
</head>
<body>
    <header>
        <div class="container">
            <h1><i class="fas fa-chart-line"></i> Catalogo Studi Plimsoll</h1>
            <div class="header-actions">
                <button id="uploadBtn" class="btn primary">
                    <i class="fas fa-upload"></i> Carica File
                </button>
                <button id="exportBtn" class="btn secondary">
                    <i class="fas fa-download"></i> Esporta Catalogo
                </button>
            </div>
        </div>
    </header>

    <main class="container">
        <!-- Dashboard Statistiche -->
        <section id="dashboard" class="dashboard">
            <div class="stat-card">
                <h3>Settori Totali</h3>
                <span id="totalSectors">0</span>
            </div>
            <div class="stat-card">
                <h3>Con Descrizione</h3>
                <span id="withDescription">0</span>
            </div>
            <div class="stat-card">
                <h3>Da Completare</h3>
                <span id="missingDescription">0</span>
            </div>
            <div class="stat-card">
                <h3>Paesi Coperti</h3>
                <span id="countriesCovered">0</span>
            </div>
        </section>

        <!-- Filtri e Ricerca -->
        <section id="filters" class="filters-section">
            <div class="search-bar">
                <i class="fas fa-search"></i>
                <input type="text" id="searchInput" placeholder="Cerca per nome settore, codice ATECO/NACE, keywords...">
            </div>
            <div class="filters">
                <select id="countryFilter">
                    <option value="">Tutti i Paesi</option>
                    <option value="IT">Italia</option>
                    <option value="UK">Regno Unito</option>
                    <option value="FR">Francia</option>
                    <option value="SP">Spagna</option>
                    <option value="PW">Mercato Globale</option>
                </select>
                <select id="naceFilter">
                    <option value="">Tutte le Sezioni NACE</option>
                </select>
                <select id="statusFilter">
                    <option value="">Tutti gli Stati</option>
                    <option value="complete">Con Descrizione</option>
                    <option value="incomplete">Senza Descrizione</option>
                </select>
            </div>
        </section>

        <!-- Tabella Settori -->
        <section id="catalog" class="catalog-section">
            <div class="table-header">
                <h2>Catalogo Settori</h2>
                <div class="table-actions">
                    <button id="bulkEditBtn" class="btn secondary">
                        <i class="fas fa-edit"></i> Modifica Multipla
                    </button>
                    <button id="addSectorBtn" class="btn primary">
                        <i class="fas fa-plus"></i> Nuovo Settore
                    </button>
                </div>
            </div>
            <div class="table-container">
                <table id="sectorsTable">
                    <thead>
                        <tr>
                            <th><input type="checkbox" id="selectAll"></th>
                            <th>Settore</th>
                            <th>Paese</th>
                            <th>NACE</th>
                            <th>ATECO</th>
                            <th>Descrizione</th>
                            <th>Keywords</th>
                            <th>Azioni</th>
                        </tr>
                    </thead>
                    <tbody id="sectorsTableBody">
                    </tbody>
                </table>
            </div>
            <div class="pagination">
                <button id="prevPage" class="btn secondary">← Precedente</button>
                <span id="pageInfo">Pagina 1 di 1</span>
                <button id="nextPage" class="btn secondary">Successiva →</button>
            </div>
        </section>
    </main>

    <!-- Modal Upload File -->
    <div id="uploadModal" class="modal">
        <div class="modal-content">
            <span class="close">&times;</span>
            <h2>Carica File Settori</h2>
            <div class="upload-zone" id="uploadZone">
                <i class="fas fa-cloud-upload-alt"></i>
                <p>Trascina i file qui o clicca per selezionare</p>
                <p class="file-types">Supportati: CSV, Excel (XLS, XLSX)</p>
                <input type="file" id="fileInput" multiple accept=".csv,.xlsx,.xls" hidden>
            </div>
            <div id="uploadProgress" class="upload-progress hidden">
                <div class="progress-bar">
                    <div class="progress-fill"></div>
                </div>
                <p id="progressText">Caricamento in corso...</p>
            </div>
            <div id="uploadResults" class="upload-results hidden"></div>
        </div>
    </div>

    <!-- Modal Modifica Settore -->
    <div id="editModal" class="modal">
        <div class="modal-content">
            <span class="close">&times;</span>
            <h2 id="editModalTitle">Modifica Settore</h2>
            <form id="editForm">
                <div class="form-group">
                    <label for="sectorName">Nome Settore:</label>
                    <input type="text" id="sectorName" required>
                </div>
                <div class="form-group">
                    <label for="sectorCountry">Paese:</label>
                    <select id="sectorCountry" required>
                        <option value="IT">Italia</option>
                        <option value="UK">Regno Unito</option>
                        <option value="FR">Francia</option>
                        <option value="SP">Spagna</option>
                        <option value="PW">Mercato Globale</option>
                    </select>
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label for="naceCode">Codice NACE:</label>
                        <input type="text" id="naceCode" maxlength="5">
                    </div>
                    <div class="form-group">
                        <label for="atecoCode">Codice ATECO:</label>
                        <input type="text" id="atecoCode" maxlength="7">
                    </div>
                </div>
                <div class="form-group">
                    <label for="sectorDescription">Descrizione:</label>
                    <textarea id="sectorDescription" rows="4" 
                              placeholder="Descrizione delle società considerate nello Studio Plimsoll..."></textarea>
                </div>
                <div class="form-group">
                    <label for="sectorKeywords">Keywords (separate da virgola):</label>
                    <input type="text" id="sectorKeywords" 
                           placeholder="es: automobili, concessionarie, automotive">
                </div>
                <div class="form-actions">
                    <button type="button" class="btn secondary" id="cancelEdit">Annulla</button>
                    <button type="submit" class="btn primary">Salva Modifiche</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Toast Notifiche -->
    <div id="toast" class="toast"></div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <script src="assets/js/data-manager.js"></script>
    <script src="assets/js/export.js"></script>
    <script src="assets/js/app.js"></script>
</body>
</html>
